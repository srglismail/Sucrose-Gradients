---
title: "Sucrose Gradients Analysis"
date: "2021-11-30"
output: github_document
author: "Ismail Sarig√ºl"
---



```{r}
library(tidyverse)
```

```{r}
library(readr)
```


```{r}
WT1 <- read_delim("Data/measurements_21-11-30_08-52-11 WT Keio OD600 0_5.lvm", 
    delim = "\t", escape_double = FALSE, 
    locale = locale(decimal_mark = ",", grouping_mark = "."), 
    trim_ws = TRUE, skip = 21,
    col_select = c("Time", "Signal"))
WT1 <- mutate(WT1, Strain="WT Keio", Sample = "exp1")

```

```{r}
WT2 <- read_delim("Data/measurements_21-11-30_08-59-00 WT Keio OD600 0_5 plus 1hour.lvm", 
    delim = "\t", escape_double = FALSE, 
    locale = locale(decimal_mark = ",", grouping_mark = "."), 
    trim_ws = TRUE, skip = 21,
    col_select = c("Time", "Signal"))
WT2 <- mutate(WT2, Strain="WT Keio", Sample = "exp2")
```

```{r}
WT3 <- read_delim("Data/measurements_21-11-30_09-04-59 WT Keio OD600 0_5 plus 2hours.lvm", 
    delim = "\t", escape_double = FALSE, 
    locale = locale(decimal_mark = ",", grouping_mark = "."), 
    trim_ws = TRUE, skip = 21,
    col_select = c("Time", "Signal"))
WT3 <- mutate(WT3, Strain="WT Keio", Sample = "stat1")
```

```{r}
ybeX1 <- read_delim("Data/measurements_21-11-30_09-12-12 ybeX OD600 0_5.lvm",
    delim = "\t", escape_double = FALSE, 
    locale = locale(decimal_mark = ",", grouping_mark = "."), 
    trim_ws = TRUE, skip = 21,
    col_select = c("Time", "Signal"))
ybeX1 <- mutate(ybeX1, Strain="ybeX", Sample = "exp1")
```

```{r}
ybeX2 <- read_delim("Data/measurements_21-11-30_09-18-33 ybeX OD600 0_5 plus 1hour.lvm",
    delim = "\t", escape_double = FALSE, 
    locale = locale(decimal_mark = ",", grouping_mark = "."), 
    trim_ws = TRUE, skip = 21,
    col_select = c("Time", "Signal"))
ybeX2 <- mutate(ybeX2, Strain="ybeX", Sample = "exp2")
```
```{r}
ybeX3 <- read_delim("Data/measurements_21-11-30_09-24-57 ybeX OD600 0_5 plus 2hours.lvm",
    delim = "\t", escape_double = FALSE, 
    locale = locale(decimal_mark = ",", grouping_mark = "."), 
    trim_ws = TRUE, skip = 21,
    col_select = c("Time", "Signal"))
ybeX3 <- mutate(ybeX3, Strain="ybeX", Sample = "stat1")
```


```{r}
bindall <- rbind(WT1, WT2, WT3, ybeX1, ybeX2, ybeX3)
```


```{r}
ggplot(data=bindall)+
    geom_line(aes(Time,Signal, color=Strain))+
  facet_wrap(~Sample)
```



```{r}
ggsave(file = "WT ybeX gradients.pdf")
```

```{r}
library(DescTools)
```

```{r}
ggplot(data=WT1)+
  geom_line(aes(Time,Signal))+
  geom_vline(xintercept = c(50,120,170,205))
```

```{r}
ggplot(data=ybeX1)+
  geom_line(aes(Time,Signal))+
  geom_vline(xintercept = c(40,115,165,193))
```

```{r}
##70S/50S for WT Keio time point 1
AUC(WT1$Time, WT1$Signal, from = min(50, na.rm = TRUE), to = max(120, na.rm = TRUE), method = c("trapezoid")) / AUC(WT1$Time, WT1$Signal, from = min(120, na.rm = TRUE), to = max(170, na.rm = TRUE), method = c("trapezoid"))

##70S/30S for WT Keio time point 1
AUC(WT1$Time, WT1$Signal, from = min(50, na.rm = TRUE), to = max(120, na.rm = TRUE), method = c("trapezoid")) / AUC(WT1$Time, WT1$Signal, from = min(170, na.rm = TRUE), to = max(200, na.rm = TRUE), method = c("trapezoid"))

##70S/50S for ybeX time point 1
AUC(ybeX1$Time, ybeX1$Signal, from = min(40, na.rm = TRUE), to = max(115, na.rm = TRUE), method = c("trapezoid")) / AUC(ybeX1$Time, ybeX1$Signal, from = min(115, na.rm = TRUE), to = max(165, na.rm = TRUE), method = c("trapezoid"))

##70S/30S for ybeX time point 1
AUC(ybeX1$Time, ybeX1$Signal, from = min(40, na.rm = TRUE), to = max(115, na.rm = TRUE), method = c("trapezoid")) / AUC(ybeX1$Time, ybeX1$Signal, from = min(165, na.rm = TRUE), to = max(193, na.rm = TRUE), method = c("trapezoid"))

```


